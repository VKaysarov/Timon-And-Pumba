<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style type="text/css">
		body {
			margin: 0;
			padding: 0;
		}
	</style>
</head>
<body>
	<!-- <input type="radio" name="hero" value="Timon"> -->
	<!-- <input type="radio" name="hero" value="Pumba"> -->
	<canvas id="canvas"></canvas>

	<script>
		const canvas = document.getElementById('canvas');
		const context = canvas.getContext('2d');
		const width = canvas.width = window.innerWidth - 5;  
		const height = canvas.height = window.innerHeight - 5;  

		let Timon = {
			hp: 100,
			x: 0,
			y: height - 300,
			vx: 0,
			vy: 0,
			height: 100,
			width: 80,
			frames: 9,
			currentFrame: 0,
			speedAnim: 0,
			sprite: 95,
			Img: new Image(),
			jump: false,
		}

		Timon.Img.src = 'Media/Спрайты король лев/Timon.png'

		let Pumba = {
			hp: 100,
			x: 0,
			y: 0,
			vx: 0,
			vy: 0,
			height: 80,
			width: 100,
			frames: 9,
			currentFrame: 0,
			speedAnim: 0,
			sprite: 0,
			Img: new Image(),
			jump: false,
		}

		Pumba.Img.src = 'Media/Спрайты король лев/Pumba.png'

		let Hyena = {
			hp: 100,
			x: 0,
			y: 0,
			vx: 0,
			vy: 0,
			height: 100,
			width: 100,
			frames: 9,
			currentFrame: 0,
			speedAnim: 0,
			sprite: 0,
			Img: new Image(),
			jump: false,
		}

		let block = {
			x: 500,
			y: height - 300,
			height: 50,
			width: 100
		}

		Hyena.Img.src = 'Media/Спрайты король лев/Hyena.png'

		let count = 0;
		let activeKey = [];

		addEventListener('keydown', function(event) {
			activeKey[event.code] = true;
		})

		addEventListener('keyup', function(event) {
			activeKey[event.code] = false;
		})

		// function timer() {
		// 	let s = 0;	
		// 	let m = 0;
		// 	setInterval(function() {
		// 		if (s < 59) {
		// 			s++;
		// 		} else {
		// 			m++
		// 		}
		// 	}, 1000)	
		// }

		function update(hero) {
			if (activeKey['ArrowLeft']) {
				hero.vx = -10
				hero.sprite = 95
			}

			if (activeKey['ArrowRight']) {
				hero.vx = 10
				hero.sprite = 95
			}

			if (activeKey['ArrowUp']) {
				if (hero.jump == false) {
					hero.vy = -20
					hero.sprite = 130
					hero.jump = true
				}
			} 

			if (activeKey['ArrowLeft'] || activeKey['ArrowRight'] || activeKey['ArrowUp']) {
				if (hero.speedAnim < 5) {
					hero.speedAnim++;
				} else {
					hero.speedAnim = 0;
					if (hero.currentFrame == hero.frames) {
						hero.currentFrame = 0;
					} else {
						hero.currentFrame++;
					}
				}
			}

			hero.vx *= 0.9;
			hero.x += hero.vx;
			hero.y += hero.vy;
			hero.vy += 1;

			if (hero.x < 0) {
				hero.x = 0
			}

			if (hero.x > width - hero.width) {
				hero.x = width - hero.width                     
			}

			if (hero.y > height - 300) {
				hero.y = height - 300
				hero.jump = false
			}

			// if (hero.x > block.x && hero.x < block.x + block.width && hero.y > block.y - hero.height) {
			// 	hero.y = block.y - hero.height
			// }

			if (hero.x + hero.width > block.x && hero.y == block.y && hero.x < block.x - block.width / 2) {
				hero.x = block.x - hero.width
			}

			if (hero.x < block.x + block.width && hero.y == block.y &&  ) {
				hero.x = block.x + block.width
			}

		}

		function render(hero) {
			context.clearRect(0, 0, width, height);

			context.beginPath();
			
			// context.drawImage(hero.Img, 31 * hero.currentFrame, hero.sprite, 25, 35, hero.x, hero.y, 50, 50)
			// console.log(hero.currentFrame)
			context.fillStyle = 'red';
			context.fillRect(width - 310, 10, hero.hp * 3, 10);
			context.fillRect(hero.x, hero.y, hero.width, hero.height);
			context.closePath();

			context.beginPath();
			context.fillStyle = 'black';
			context.fillRect(block.x, block.y, block.width, block.height)
			context.closePath();

			
		}

		function main() {
			update(Timon)
			render(Timon)

			requestAnimationFrame(main)
		}

		main()
	</script>
</body>
</html>